<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Available Tests | Candidate</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="candidate-dashboard.css">
</head>

<body>

    <!-- 1ï¸âƒ£ Navigation Bar -->
    <nav class="navbar">
        <div class="brand">
            <div class="brand-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3v18h18" />
                    <path d="M18 17V9" />
                    <path d="M13 17V5" />
                    <path d="M8 17v-3" />
                </svg>
            </div>
            <span>Candidate Dashboard</span>
        </div>

        <div class="nav-links">
            <a href="dashboard.html" class="nav-btn">Dashboard</a>
            <a href="tests.html" class="nav-btn active">Tests</a>

            <div class="profile-container">
                <div class="profile-trigger">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <div class="profile-dropdown">
                    <div class="dropdown-item profile-link">Profile</div>
                    <div class="dropdown-item logout-btn">Logout</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 2ï¸âƒ£ Main Layout -->
    <main class="main-container">

        <div style="margin-bottom: 2rem;">
            <h2 style="font-size: 1.75rem; font-weight: 700; color: var(--text-main);">Available Tests</h2>
            <p style="color: var(--text-muted);">Select a test to begin your assessment journey.</p>
        </div>

        <!-- Tests Grid -->
        <div class="tests-grid" id="testsGrid">
            <!-- Dynamic Content -->
        </div>

    </main>

    <!-- Logic Script -->
    <script src="mock-data.js"></script>
    <script src="candidate.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const grid = document.getElementById('testsGrid');

            // Render Tests Function
            function renderTests(filter = '') {
                grid.innerHTML = '';
                const term = filter.toLowerCase();

                if (typeof AVAILABLE_TESTS === 'undefined') {
                    grid.innerHTML = '<div style="padding:2rem;">Loading tests...</div>';
                    return;
                }

                const filteredTests = AVAILABLE_TESTS.filter(test =>
                    !filter ||
                    test.role.toLowerCase().includes(term) ||
                    test.company.toLowerCase().includes(term)
                );

                filteredTests.forEach(test => {
                    const card = document.createElement('div');
                    card.className = 'test-card';
                    card.innerHTML = `
                        <img src="${test.logo}" alt="${test.company}" class="company-logo" style="height:48px; object-fit:contain;">
                        <div class="role-title">${test.role}</div>
                        <div class="role-desc">${test.company} â€¢ ${test.location}</div>
                        <div style="font-size:0.8rem; color:var(--text-muted); margin-bottom:1rem;">
                            ${test.questions} Qs â€¢ ${test.duration} Mins â€¢ ${test.difficulty}
                        </div>
                        <!-- ðŸš€ N8N INTEGRATION: APPLY ACTION -->
                        <button class="btn-apply" onclick="window.candidateState.applyForTest('${test.id}', '${test.company}')">
                            Start Test
                        </button>
                    `;
                    grid.appendChild(card);
                });

                if (filteredTests.length === 0) {
                    grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:3rem; color:var(--text-muted);">No tests found matching criteria.</div>';
                }
            }

            // Initial Render
            renderTests();
        });
    </script>
</body>

</html>